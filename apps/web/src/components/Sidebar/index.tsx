import { useState } from 'react';
import Link from 'next/link';

import Actions from './actions';
import Menu from './menu';
import sidebarMenu from 'config/menu/sidebar-static';
import { useWorkspaces } from 'lib/client';
import { useWorkspace } from 'providers/workspace';
import { MenuIcon } from '@heroicons/react/outline';

const staticMenu = sidebarMenu();

const Sidebar = ({ menu }) => {
  const [showMenu, setMenuVisibility] = useState(false);
  const { data, isLoading } = useWorkspaces();
  const { workspace } = useWorkspace();

  const renderMenu = () => {
    return (
      workspace &&
      menu.map((item, index) => (
        <Menu key={index} data={item} isLoading={isLoading} showMenu={data?.workspaces?.length > 0 || isLoading} />
      ))
    );
  };

  const renderStaticMenu = () => {
    return staticMenu.map((item, index) => <Menu key={index} data={item} showMenu={true} />);
  };

  const toggleMenu = () => setMenuVisibility(!showMenu);

  return (
    <aside className="sticky z-40 flex flex-col space-y-2 text-white bg-secondary-deep-blue md:overflow-y-auto md:w-1/8 md:h-screen overscroll-contain">
      <div className="relative flex items-center justify-center py-4 px-2 mx-8 text-center border-b border-b-gray">
        <Link href="/account">
          <svg width="59" height="24" viewBox="0 0 59 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M4.64913 12.4165C3.72962 12.4165 2.83076 12.1439 2.06621 11.633C1.30167 11.1222 0.705776 10.3961 0.353894 9.54656C0.00201288 8.69704 -0.0900533 7.76226 0.0893343 6.86042C0.268722 5.95857 0.711506 5.13018 1.3617 4.47999C2.01189 3.82979 2.84029 3.38701 3.74213 3.20762C4.64397 3.02823 5.57875 3.1203 6.42827 3.47218C7.27779 3.82406 8.00388 4.41995 8.51474 5.1845C9.02559 5.94904 9.29825 6.84791 9.29825 7.76742C9.29589 8.99971 8.80532 10.1809 7.93395 11.0522C7.06258 11.9236 5.88143 12.4142 4.64913 12.4165ZM4.6831 4.62925C4.0567 4.6289 3.44426 4.81433 2.92325 5.16208C2.40224 5.50984 1.99607 6.00429 1.75611 6.58291C1.51615 7.16153 1.45318 7.79832 1.57517 8.41274C1.69716 9.02715 1.99863 9.59158 2.44144 10.0346C2.88425 10.4777 3.44851 10.7795 4.06285 10.9018C4.67719 11.0242 5.31402 10.9615 5.89277 10.7219C6.47153 10.4823 6.96622 10.0764 7.31426 9.55557C7.66231 9.03476 7.84808 8.42243 7.84808 7.79602C7.84785 7.37962 7.76554 6.96735 7.60587 6.58278C7.44619 6.19821 7.21228 5.84888 6.91751 5.55477C6.62273 5.26066 6.27288 5.02754 5.88795 4.86873C5.50302 4.70993 5.09056 4.62855 4.67416 4.62925H4.6831Z"
              fill="white"
            />
            <path
              d="M4.64913 24C3.72962 24 2.83076 23.7274 2.06621 23.2165C1.30167 22.7057 0.705776 21.9796 0.353894 21.1301C0.00201288 20.2805 -0.0900533 19.3458 0.0893343 18.4439C0.268722 17.5421 0.711506 16.7137 1.3617 16.0635C2.01189 15.4133 2.84029 14.9705 3.74213 14.7911C4.64397 14.6117 5.57875 14.7038 6.42827 15.0557C7.27779 15.4076 8.00388 16.0034 8.51474 16.768C9.02559 17.5325 9.29825 18.4314 9.29825 19.3509C9.29589 20.5832 8.80532 21.7644 7.93395 22.6357C7.06258 23.5071 5.88143 23.9977 4.64913 24ZM4.64913 16.2271C4.0322 16.2253 3.42861 16.4065 2.91472 16.7479C2.40083 17.0892 1.99973 17.5754 1.76217 18.1447C1.52461 18.7141 1.46127 19.3411 1.58015 19.9465C1.69903 20.5518 1.9948 21.1083 2.43003 21.5456C2.86526 21.9828 3.42041 22.2811 4.02522 22.4028C4.63004 22.5244 5.25735 22.464 5.82779 22.229C6.39824 21.9941 6.88618 21.5952 7.22988 21.0829C7.57359 20.5706 7.75761 19.9678 7.75868 19.3509C7.75869 18.5251 7.43147 17.7328 6.84868 17.1477C6.26588 16.5625 5.47498 16.2322 4.64913 16.2288V16.2271Z"
              fill="white"
            />
            <path
              d="M10.3406 3.84968C11.1514 3.84968 11.8087 3.19241 11.8087 2.38163C11.8087 1.57084 11.1514 0.913574 10.3406 0.913574C9.52983 0.913574 8.87256 1.57084 8.87256 2.38163C8.87256 3.19241 9.52983 3.84968 10.3406 3.84968Z"
              fill="#FFC500"
            />
            <path
              d="M16.3773 10.598C15.721 10.5873 15.3884 10.0616 15.3884 9.02445V0.81695C15.3935 0.711546 15.3771 0.606215 15.3402 0.507336C15.3034 0.408457 15.2468 0.318087 15.174 0.241705C15.1012 0.165323 15.0137 0.104517 14.9167 0.0629702C14.8197 0.0214233 14.7152 0 14.6097 0C14.5042 0 14.3997 0.0214233 14.3027 0.0629702C14.2057 0.104517 14.1182 0.165323 14.0454 0.241705C13.9726 0.318087 13.916 0.408457 13.8792 0.507336C13.8423 0.606215 13.8259 0.711546 13.831 0.81695V9.02445C13.831 10.9056 14.827 12.1215 16.3701 12.1215C16.5721 12.1215 16.7659 12.0412 16.9087 11.8984C17.0516 11.7555 17.1319 11.5618 17.1319 11.3597C17.1319 11.1577 17.0516 10.964 16.9087 10.8211C16.7659 10.6783 16.5721 10.598 16.3701 10.598H16.3773Z"
              fill="white"
            />
            <path
              d="M26.1175 2.94839C25.9752 2.94452 25.8348 2.9822 25.7135 3.05682C25.5922 3.13144 25.4952 3.23978 25.4345 3.3686L22.5306 9.72718L19.6875 3.42403C19.6312 3.28113 19.5324 3.15891 19.4045 3.07386C19.2766 2.98881 19.1258 2.94502 18.9722 2.94839C18.8486 2.94717 18.7265 2.97621 18.6166 3.03297C18.5068 3.08974 18.4125 3.17251 18.342 3.27407C18.2714 3.37563 18.2268 3.4929 18.212 3.61565C18.1972 3.73841 18.2126 3.86293 18.257 3.97835L18.2695 4.01769L21.7027 11.5278L21.5239 11.9105C21.0822 12.8814 20.5708 13.4018 20.0057 13.459C19.8135 13.4816 19.6371 13.5764 19.5121 13.7241C19.3871 13.8719 19.3228 14.0616 19.3324 14.2549C19.3419 14.4482 19.4245 14.6307 19.5635 14.7654C19.7024 14.9002 19.8873 14.9771 20.0808 14.9807C20.1668 14.982 20.2527 14.973 20.3365 14.9539C21.4201 14.7572 22.2892 13.9418 22.9204 12.5327L26.7935 4.04094C26.8404 3.93627 26.8654 3.82306 26.8668 3.70834C26.8663 3.50878 26.7876 3.31736 26.6475 3.17524C26.5074 3.03313 26.3171 2.95167 26.1175 2.94839Z"
              fill="white"
            />
            <path
              d="M32.8549 2.88045C31.9255 2.86024 31.013 3.13025 30.2442 3.65292C30.2393 3.55089 30.2143 3.45083 30.1707 3.35846C30.1271 3.26608 30.0658 3.1832 29.9901 3.11454C29.9145 3.04588 29.8261 2.99279 29.7299 2.9583C29.6338 2.92381 29.5318 2.9086 29.4297 2.91353C29.3277 2.91846 29.2277 2.94344 29.1353 2.98704C29.0429 3.03064 28.96 3.09201 28.8914 3.16765C28.8227 3.24328 28.7696 3.33169 28.7351 3.42784C28.7006 3.52399 28.6854 3.62599 28.6904 3.72802V14.1653C28.6853 14.2707 28.7017 14.376 28.7386 14.4749C28.7754 14.5738 28.832 14.6642 28.9048 14.7406C28.9776 14.8169 29.0651 14.8777 29.1621 14.9193C29.2591 14.9608 29.3636 14.9823 29.4691 14.9823C29.5746 14.9823 29.679 14.9608 29.776 14.9193C29.873 14.8777 29.9606 14.8169 30.0334 14.7406C30.1062 14.6642 30.1628 14.5738 30.1996 14.4749C30.2365 14.376 30.2529 14.2707 30.2478 14.1653V11.4706C31.016 11.9913 31.9271 12.26 32.8549 12.2395C35.3833 12.2395 37.4414 10.1367 37.4414 7.55282C37.4424 6.3169 36.953 5.13109 36.0807 4.25552C35.6622 3.82237 35.1611 3.47751 34.607 3.24133C34.053 3.00515 33.4572 2.88244 32.8549 2.88045ZM32.8549 4.40394C34.4875 4.40394 35.8661 5.84516 35.8661 7.55282C35.8661 9.26048 34.4875 10.7178 32.8549 10.7178C31.7105 10.7178 30.7002 10.1689 30.2478 9.31413V5.82192C30.6966 4.95825 31.7087 4.40394 32.8549 4.40394Z"
              fill="white"
            />
            <path
              d="M44.0075 2.88039C42.9906 2.85532 41.9909 3.14646 41.1465 3.71366V0.816897C41.1465 0.610602 41.0645 0.412757 40.9187 0.266885C40.7728 0.121013 40.575 0.0390625 40.3687 0.0390625C40.1624 0.0390625 39.9645 0.121013 39.8186 0.266885C39.6728 0.412757 39.5908 0.610602 39.5908 0.816897V11.3436C39.5908 11.5499 39.6728 11.7477 39.8186 11.8936C39.9645 12.0395 40.1624 12.1214 40.3687 12.1214C40.575 12.1214 40.7728 12.0395 40.9187 11.8936C41.0645 11.7477 41.1465 11.5499 41.1465 11.3436V5.84511C41.6275 4.96714 42.7039 4.40388 43.9235 4.40388C45.6669 4.40388 46.4447 5.23893 46.4447 7.11289V11.3436C46.4543 11.5437 46.5405 11.7324 46.6855 11.8706C46.8305 12.0088 47.0231 12.0859 47.2234 12.0859C47.4237 12.0859 47.6164 12.0088 47.7614 11.8706C47.9063 11.7324 47.9926 11.5437 48.0022 11.3436V7.05209C48.0022 4.4754 46.4715 2.88039 44.0075 2.88039Z"
              fill="white"
            />
            <path
              d="M58.4718 10.868L55.3516 7.54921L58.4718 4.21972L58.4969 4.1929L58.5237 4.15356C58.6208 4.02632 58.6724 3.87017 58.6703 3.71011C58.6703 3.50839 58.5903 3.31491 58.4478 3.17211C58.3054 3.0293 58.1121 2.94884 57.9104 2.94836C57.7977 2.94958 57.6867 2.97513 57.5848 3.02328C57.483 3.07143 57.3927 3.14103 57.3203 3.22731L54.3216 6.42627L51.3193 3.22731C51.2472 3.14116 51.1572 3.07163 51.0557 3.02349C50.9542 2.97534 50.8434 2.94971 50.731 2.94836C50.631 2.94836 50.532 2.96807 50.4395 3.00635C50.3471 3.04463 50.2631 3.10074 50.1924 3.17147C50.1217 3.24221 50.0656 3.32618 50.0273 3.4186C49.989 3.51102 49.9693 3.61007 49.9693 3.71011C49.9672 3.87017 50.0188 4.02632 50.1159 4.15356L50.1427 4.19469L53.2863 7.54921L50.1892 10.8483L50.1606 10.8841C50.047 11.016 49.9837 11.1838 49.9818 11.3579C49.9818 11.5599 50.0621 11.7537 50.2049 11.8966C50.3478 12.0394 50.5415 12.1197 50.7436 12.1197C50.8396 12.1214 50.935 12.1038 51.0241 12.0678C51.1132 12.0319 51.1942 11.9784 51.2621 11.9105L54.3144 8.65964L57.3543 11.9015L57.365 11.9105C57.4329 11.9784 57.5139 12.0319 57.603 12.0678C57.6921 12.1038 57.7875 12.1214 57.8835 12.1197C58.0856 12.1197 58.2793 12.0394 58.4222 11.8966C58.565 11.7537 58.6453 11.5599 58.6453 11.3579C58.6434 11.1838 58.5801 11.016 58.4665 10.8841L58.4718 10.868Z"
              fill="white"
            />
          </svg>
        </Link>
        <button className="absolute right-0 p-5 md:hidden" onClick={toggleMenu}>
          <MenuIcon className="w-6 h-6" />
        </button>
      </div>
      <div
        className={[
          'flex-col space-y-5 md:flex md:relative md:top-0',
          showMenu ? 'absolute top-12 bg-primary-dark-blue right-0 left-0 h-screen' : 'hidden',
        ].join(' ')}
      >
        <Actions />
        <div className="flex flex-col p-5 space-y-10">
          {renderStaticMenu()}
          {renderMenu()}
        </div>
      </div>
    </aside>
  );
};

export default Sidebar;
